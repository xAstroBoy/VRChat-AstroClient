namespace AstroClient.Features.Player.Movement.Exploit
{
	using AstroClient.Extensions;
	using AstroClient.Features.Player;
	using AstroClient.Utils.Player;
	using RubyButtonAPI;
	using System;
	using System.Collections.Generic;
	using UnityEngine;
	using VRC.SDKBase;


	public class MovementSerializer : GameEvents
	{


		public override void OnLevelLoaded()
		{
			if(Capsule != null)
			{
				Capsule.DestroyMeLocal();
			}
		}

		public static void CustomSerialize(bool Toggle)
		{
			try
			{
				if (Toggle)
				{
					Capsule = PlayerCloner.CloneLocalPlayerAvatar();
				}
				else
				{

					Capsule.DestroyMeLocal();
				}
			}
			catch
			{
			}
		}



		private static bool _Enabled;
		public static bool Enabled
		{
			get
			{
				return _Enabled;
			}
			set
			{

				_Enabled = value;
				if (SerializerBtn != null)
				{
					SerializerBtn.SetToggleState(value);
				}
				CustomSerialize(value);

			}
		}




		public static QMToggleButton SerializerBtn;
		public static GameObject Capsule;

	}
}
